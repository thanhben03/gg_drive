import{o as i,f,b as e,c as I,w,t as b,d as g,a as o,j as v,Q as E,T as V,k as O,F as S,u as p,n as D,l as Q,m as X,h as J,p as Y,Z as ee,q as U,i as j,g as M,e as te,O as z}from"./app-ImTeHo3O.js";import{e as $,F as le,s as H,a as A,b as se,O as ae,S as oe,A as ne,c as re}from"./AuthenticatedLayout-l7-ZxOOj.js";import{_ as ie,h as de,a as ce}from"./http-helper--CrT2N5H.js";import{_ as B}from"./Checkbox-4aAaSSK5.js";import{_ as P}from"./Modal-qVR1ryoo.js";import{_ as R}from"./SecondaryButton-yAsrplH_.js";import{D as ue}from"./DangerButton-Xn3o4_BL.js";import{_ as me}from"./DownloadFileButton-KLs4OlVd.js";import{_ as fe,a as he,b as pe}from"./TextInput-vBC3avoD.js";import{P as _e}from"./PrimaryButton-firhvslF.js";import"./ApplicationLogo-yTz1-3l3.js";import"./_plugin-vue_export-helper-x3n3nnut.js";function xe(u,n){return i(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M9.293 2.293a1 1 0 0 1 1.414 0l7 7A1 1 0 0 1 17 11h-1v6a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-6H3a1 1 0 0 1-.707-1.707l7-7Z","clip-rule":"evenodd"})])}const ve={class:"p-6"},ge=e("h2",{class:"text-2xl mb-2 font-semibold"},"Please Confirm",-1),we={class:"mt-6 flex justify-end"},ye={__name:"ConfirmationDialog",props:{show:Boolean,message:String},emits:["cancel","confirm"],setup(u,{emit:n}){const t=n;return(a,d)=>(i(),I(P,{show:u.show,"max-width":"md"},{default:w(()=>[e("div",ve,[ge,e("p",null,b(u.message),1),e("div",we,[o(R,{onClick:d[0]||(d[0]=h=>t("cancel"))},{default:w(()=>[g("Cancel")]),_:1}),o(ue,{class:"ml-3",onClick:d[1]||(d[1]=h=>t("confirm"))},{default:w(()=>[g(" Confirm ")]),_:1})])])]),_:1},8,["show"]))}},ke=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1),be={__name:"DeleteFilesButton",props:{deleteAll:{type:Boolean,required:!1,default:!1},deleteIds:{type:Array,required:!1}},emits:["delete"],setup(u,{emit:n}){const t=u,a=v(!1),d=n,h=E(),m=V({all:null,ids:[],parent_id:null});function _(){if(!t.deleteAll&&!t.deleteIds.length){H("Please select at least one file to delete");return}a.value=!0}function c(){a.value=!1}function x(){m.parent_id=h.props.folder.id,t.deleteAll?m.all=!0:m.ids=t.deleteIds,m.delete(route("file.delete"),{onSuccess:()=>{a.value=!1,d("delete"),A("Selected files have been deleted")}})}return O(()=>{$.on(le,_)}),(y,C)=>(i(),f(S,null,[e("button",{onClick:_,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},[ke,g(" Delete ")]),o(ye,{show:a.value,message:"Are you sure you want to delete selected files?",onCancel:c,onConfirm:x},null,8,["show"])],64))}},Ce={class:"p-6"},Se=e("h2",{class:"text-lg font-medium text-gray-900"}," Share Files ",-1),$e={class:"mt-6"},Ee={class:"mt-6 flex justify-end"},Fe={__name:"ShareFilesModal",props:{modelValue:Boolean,allSelected:Boolean,selectedIds:Array},emits:["update:modelValue"],setup(u,{emit:n}){const t=V({email:null,all:!1,ids:[],parent_id:null}),a=E(),d=v(null),h=u,m=n;function _(){X(()=>d.value.focus())}function c(){t.parent_id=a.props.folder.id,console.log(h.selectedIds,h.allSelected),h.allSelected?(t.all=!0,t.ids=[]):t.ids=h.selectedIds;const y=t.email;t.post(route("file.share"),{preserveScroll:!0,onSuccess:()=>{x(),t.reset(),A(`Selected files will be shared to "${y}" if the emails exists in the system`)},onError:()=>d.value.focus()})}function x(){m("update:modelValue"),t.clearErrors(),t.reset()}return(y,C)=>(i(),I(P,{show:h.modelValue,onShow:_,"max-width":"sm"},{default:w(()=>[e("div",Ce,[Se,e("div",$e,[o(fe,{for:"shareEmail",value:"Enter Email Address",class:"sr-only"}),o(he,{type:"text",ref_key:"emailInput",ref:d,id:"shareEmail",modelValue:p(t).email,"onUpdate:modelValue":C[0]||(C[0]=F=>p(t).email=F),class:D([p(t).errors.email?"border-red-500 focus:border-red-500 focus:ring-red-500":"","mt-1 block w-full"]),placeholder:"Enter Email Address",onKeyup:Q(c,["enter"])},null,8,["modelValue","class"]),o(pe,{message:p(t).errors.email,class:"mt-2"},null,8,["message"])]),e("div",Ee,[o(R,{onClick:x},{default:w(()=>[g("Cancel")]),_:1}),o(_e,{class:D(["ml-3",{"opacity-25":p(t).processing}]),onClick:c,disable:p(t).processing},{default:w(()=>[g(" Submit ")]),_:1},8,["class","disable"])])])]),_:1},8,["show"]))}},Me=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{"fill-rule":"evenodd",d:"M15.75 4.5a3 3 0 11.825 2.066l-8.421 4.679a3.002 3.002 0 010 1.51l8.421 4.679a3 3 0 11-.729 1.31l-8.421-4.678a3 3 0 110-4.132l8.421-4.679a3 3 0 01-.096-.755z","clip-rule":"evenodd"})],-1),Be={__name:"ShareFilesButton",props:{allSelected:{type:Boolean,required:!1,default:!1},selectedIds:{type:Array,required:!1}},emits:["restore"],setup(u,{emit:n}){E(),V({all:null,ids:[],parent_id:null});const t=v(!1),a=u;function d(){if(!a.allSelected&&!a.selectedIds.length){H("Please select at least one file to share");return}t.value=!0}return O(()=>{$.on(se,d)}),(h,m)=>(i(),f(S,null,[e("button",{onClick:d,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white mr-3"},[Me,g(" Share ")]),o(Fe,{modelValue:t.value,"onUpdate:modelValue":m[0]||(m[0]=_=>t.value=_),"all-selected":u.allSelected,"selected-ids":u.selectedIds},null,8,["modelValue","all-selected","selected-ids"])],64))}},De={class:"flex items-center justify-between p-1 mb-3"},Ie={class:"inline-flex items-center space-x-1 md:space-x-3"},Ve={key:1,class:"flex items-center"},Oe=e("svg",{"aria-hidden":"true",class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),Ae={class:"flex"},Le={class:"flex items-center mr-3"},Ne={class:"flex-1 overflow-auto"},Ue={class:"min-w-full"},je={class:"bg-gray-100 border-b"},ze={class:"text-sm font-medium text-gray-900 px-6 py-4 text-left w-[30px] max-w-[30px] pr-0"},He=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},null,-1),Pe=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Name ",-1),Re={key:0,class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Te=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Owner ",-1),qe=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Last Modified ",-1),Ke=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Size ",-1),We=["onClick","onDblclick","onContextmenu"],Ze={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 w-[30px] max-w-[30px] pr-0"},Ge={class:"px-6 py-4 max-w-[40px] text-sm font-medium text-gray-900 text-yellow-500"},Qe=["onClick"],Xe={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},Je=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"},null,-1),Ye=[Je],et={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6"},tt=e("path",{"fill-rule":"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z","clip-rule":"evenodd"},null,-1),lt=[tt],st={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 flex items-center"},at={key:0,class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ot={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},nt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},rt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},it={key:0,class:"py-8 text-center text-sm text-gray-400"},yt={__name:"MyFiles",props:{files:Object,folder:Object,ancestors:Object},setup(u){E();const n=v(!1),t=v(!1),a=v({}),d=v(null),h=v(!1);let m=v("");const _=u,c=v({data:_.files.data,next:_.files.links.next});let x=null;const y=J(()=>Object.entries(a.value).filter(s=>s[1]).map(s=>s[0]));function C(s){s.is_folder&&z.visit(route("myFiles",{folder:s.path}))}function F(){c.value.next!==null&&de(c.value.next).then(s=>{c.value.data=[...c.value.data,...s.data],c.value.next=s.links.next})}function T(){c.value.data.forEach(s=>{a.value[s.id]=n.value})}function L(s){a.value[s.id]=!a.value[s.id],N(s)}function N(s){if(!a.value[s.id])n.value=!1;else{let r=!0;for(let l of c.value.data)if(!a.value[l.id]){r=!1;break}n.value=r}}function q(){n.value=!1,a.value={}}function K(s){ce(route("file.addToFavourites"),{id:s.id}).then(()=>{s.is_favourite=!s.is_favourite,A("Selected files have been added to favourites")}).catch(async r=>{console.log(r.error.message)})}function W(){t.value?x.set("favourites",1):x.delete("favourites"),z.get(window.location.pathname+"?"+x.toString())}function Z(s,r){s.preventDefault(),a.value[r.id]||L(r),$.emit(re,{e:s,file:r})}function G(){h.value=!0}return Y(()=>{c.value={data:_.files.data,next:_.files.links.next}}),O(()=>{x=new URLSearchParams(window.location.search),t.value=x.get("favourites")==="1",m.value=x.get("search"),$.on(ae,r=>{m.value=r}),$.on(oe,G),new IntersectionObserver(r=>r.forEach(l=>l.isIntersecting&&F()),{rootMargin:"-250px 0px 0px 0px"}).observe(d.value)}),(s,r)=>(i(),f(S,null,[o(p(ee),{title:"My Drive"}),o(ne,null,{default:w(()=>[e("nav",De,[e("ol",Ie,[(i(!0),f(S,null,U(u.ancestors.data,l=>(i(),f("li",{key:l.id,class:"inline-flex items-center"},[l.parent_id?(i(),f("div",Ve,[Oe,o(p(j),{href:s.route("myFiles",{folder:l.path}),class:"ml-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ml-2 dark:text-gray-400 dark:hover:text-white"},{default:w(()=>[g(b(l.name),1)]),_:2},1032,["href"])])):(i(),I(p(j),{key:0,href:s.route("myFiles"),class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"},{default:w(()=>[o(p(xe),{class:"w-4 h-4"}),g(" My Files ")]),_:1},8,["href"]))]))),128))]),e("div",Ae,[e("label",Le,[g(" Only Favourites "),o(B,{onChange:W,checked:t.value,"onUpdate:checked":r[0]||(r[0]=l=>t.value=l),class:"ml-2"},null,8,["checked"])]),o(Be,{"all-selected":n.value,"selected-ids":y.value},null,8,["all-selected","selected-ids"]),o(me,{all:n.value,ids:y.value,class:"mr-2"},null,8,["all","ids"]),o(be,{"delete-all":n.value,"delete-ids":y.value,onDelete:q},null,8,["delete-all","delete-ids"])])]),e("div",Ne,[e("table",Ue,[e("thead",je,[e("tr",null,[e("th",ze,[o(B,{onChange:T,checked:n.value,"onUpdate:checked":r[1]||(r[1]=l=>n.value=l)},null,8,["checked"])]),He,Pe,p(m)?(i(),f("th",Re," Path ")):M("",!0),Te,qe,Ke])]),e("tbody",null,[(i(!0),f(S,null,U(c.value.data,l=>(i(),f("tr",{key:l.id,onClick:k=>L(l),onDblclick:k=>C(l),onContextmenu:k=>Z(k,l),class:D(["border-b transition duration-300 ease-in-out hover:bg-blue-100 cursor-pointer",a.value[l.id]||n.value?"bg-blue-50":"bg-white"])},[e("td",Ze,[o(B,{onChange:k=>N(l),modelValue:a.value[l.id],"onUpdate:modelValue":k=>a.value[l.id]=k,checked:a.value[l.id]||n.value},null,8,["onChange","modelValue","onUpdate:modelValue","checked"])]),e("td",Ge,[e("div",{onClick:te(k=>K(l),["stop","prevent"])},[l.is_favourite?(i(),f("svg",et,lt)):(i(),f("svg",Xe,Ye))],8,Qe)]),e("td",st,[o(ie,{file:l},null,8,["file"]),g(" "+b(l.name),1)]),p(m)?(i(),f("td",at,b(l.path),1)):M("",!0),e("td",ot,b(l.owner),1),e("td",nt,b(l.updated_at),1),e("td",rt,b(l.size),1)],42,We))),128))])]),c.value.data.length?M("",!0):(i(),f("div",it," There is no data in this folder ")),e("div",{ref_key:"loadMoreIntersect",ref:d},null,512)])]),_:1})],64))}};export{yt as default};
